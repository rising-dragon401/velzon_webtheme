import{elementChildren}from"../../shared/utils.js";export default function Parallax({swiper:a,extendParams:r,on:e}){r({parallax:{enabled:!1}});const t=(r,e)=>{const{rtl:t}=a,l=t?-1:1,s=r.getAttribute("data-swiper-parallax")||"0";let p=r.getAttribute("data-swiper-parallax-x"),i=r.getAttribute("data-swiper-parallax-y");const d=r.getAttribute("data-swiper-parallax-scale"),n=r.getAttribute("data-swiper-parallax-opacity"),x=r.getAttribute("data-swiper-parallax-rotate");if(p||i?(p=p||"0",i=i||"0"):a.isHorizontal()?(p=s,i="0"):(i=s,p="0"),p=p.indexOf("%")>=0?parseInt(p,10)*e*l+"%":p*e*l+"px",i=i.indexOf("%")>=0?parseInt(i,10)*e+"%":i*e+"px",null!=n){const a=n-(n-1)*(1-Math.abs(e));r.style.opacity=a}let o=`translate3d(${p}, ${i}, 0px)`;if(null!=d){o+=` scale(${d-(d-1)*(1-Math.abs(e))})`}if(x&&null!=x){o+=` rotate(${x*e*-1}deg)`}r.style.transform=o},l=()=>{const{el:r,slides:e,progress:l,snapGrid:s}=a;elementChildren(r,"[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]").forEach((a=>{t(a,l)})),e.forEach(((r,e)=>{let p=r.progress;a.params.slidesPerGroup>1&&"auto"!==a.params.slidesPerView&&(p+=Math.ceil(e/2)-l*(s.length-1)),p=Math.min(Math.max(p,-1),1),r.querySelectorAll("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale], [data-swiper-parallax-rotate]").forEach((a=>{t(a,p)}))}))};e("beforeInit",(()=>{a.params.parallax.enabled&&(a.params.watchSlidesProgress=!0,a.originalParams.watchSlidesProgress=!0)})),e("init",(()=>{a.params.parallax.enabled&&l()})),e("setTranslate",(()=>{a.params.parallax.enabled&&l()})),e("setTransition",((r,e)=>{a.params.parallax.enabled&&((r=a.params.speed)=>{const{el:e}=a;e.querySelectorAll("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y], [data-swiper-parallax-opacity], [data-swiper-parallax-scale]").forEach((a=>{let e=parseInt(a.getAttribute("data-swiper-parallax-duration"),10)||r;0===r&&(e=0),a.style.transitionDuration=`${e}ms`}))})(e)}))}