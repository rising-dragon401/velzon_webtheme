import zeroFill from"../utils/zero-fill";import isFunction from"../utils/is-function";export var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={};export var formatTokenFunctions={};export function addFormatToken(o,t,n,r){var a=r;"string"==typeof r&&(a=function(){return this[r]()}),o&&(formatTokenFunctions[o]=a),t&&(formatTokenFunctions[t[0]]=function(){return zeroFill(a.apply(this,arguments),t[1],t[2])}),n&&(formatTokenFunctions[n]=function(){return this.localeData().ordinal(a.apply(this,arguments),o)})}function removeFormattingTokens(o){return o.match(/\[[\s\S]/)?o.replace(/^\[|\]$/g,""):o.replace(/\\/g,"")}function makeFormatFunction(o){var t,n,r=o.match(formattingTokens);for(t=0,n=r.length;t<n;t++)formatTokenFunctions[r[t]]?r[t]=formatTokenFunctions[r[t]]:r[t]=removeFormattingTokens(r[t]);return function(t){var a,e="";for(a=0;a<n;a++)e+=isFunction(r[a])?r[a].call(t,o):r[a];return e}}export function formatMoment(o,t){return o.isValid()?(t=expandFormat(t,o.localeData()),formatFunctions[t]=formatFunctions[t]||makeFormatFunction(t),formatFunctions[t](o)):o.localeData().invalidDate()}export function expandFormat(o,t){var n=5;function r(o){return t.longDateFormat(o)||o}for(localFormattingTokens.lastIndex=0;n>=0&&localFormattingTokens.test(o);)o=o.replace(localFormattingTokens,r),localFormattingTokens.lastIndex=0,n-=1;return o}