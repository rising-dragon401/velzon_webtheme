import{get}from"../moment/get-set";import hasOwnProp from"../utils/has-own-prop";import{addFormatToken}from"../format/format";import{addUnitAlias}from"./aliases";import{addUnitPriority}from"./priorities";import{addRegexToken,match1to2,match2,matchWord,regexEscape}from"../parse/regex";import{addParseToken}from"../parse/token";import{hooks}from"../utils/hooks";import{MONTH}from"./constants";import toInt from"../utils/to-int";import isArray from"../utils/is-array";import isNumber from"../utils/is-number";import mod from"../utils/mod";import indexOf from"../utils/index-of";import{createUTC}from"../create/utc";import getParsingFlags from"../create/parsing-flags";import{isLeapYear}from"../units/year";export function daysInMonth(t,o){if(isNaN(t)||isNaN(o))return NaN;var s=mod(o,12);return t+=(o-s)/12,1===s?isLeapYear(t)?29:28:31-s%7%2}addFormatToken("M",["MM",2],"Mo",(function(){return this.month()+1})),addFormatToken("MMM",0,0,(function(t){return this.localeData().monthsShort(this,t)})),addFormatToken("MMMM",0,0,(function(t){return this.localeData().months(this,t)})),addUnitAlias("month","M"),addUnitPriority("month",8),addRegexToken("M",match1to2),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",(function(t,o){return o.monthsShortRegex(t)})),addRegexToken("MMMM",(function(t,o){return o.monthsRegex(t)})),addParseToken(["M","MM"],(function(t,o){o[MONTH]=toInt(t)-1})),addParseToken(["MMM","MMMM"],(function(t,o,s,e){var r=s._locale.monthsParse(t,e,s._strict);null!=r?o[MONTH]=r:getParsingFlags(s).invalidMonth=t}));var MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;export var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_");export function localeMonths(t,o){return t?isArray(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(o)?"format":"standalone"][t.month()]:isArray(this._months)?this._months:this._months.standalone}export var defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");export function localeMonthsShort(t,o){return t?isArray(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(o)?"format":"standalone"][t.month()]:isArray(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function handleStrictParse(t,o,s){var e,r,n,h=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],e=0;e<12;++e)n=createUTC([2e3,e]),this._shortMonthsParse[e]=this.monthsShort(n,"").toLocaleLowerCase(),this._longMonthsParse[e]=this.months(n,"").toLocaleLowerCase();return s?"MMM"===o?-1!==(r=indexOf.call(this._shortMonthsParse,h))?r:null:-1!==(r=indexOf.call(this._longMonthsParse,h))?r:null:"MMM"===o?-1!==(r=indexOf.call(this._shortMonthsParse,h))||-1!==(r=indexOf.call(this._longMonthsParse,h))?r:null:-1!==(r=indexOf.call(this._longMonthsParse,h))||-1!==(r=indexOf.call(this._shortMonthsParse,h))?r:null}export function localeMonthsParse(t,o,s){var e,r,n;if(this._monthsParseExact)return handleStrictParse.call(this,t,o,s);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),e=0;e<12;e++){if(r=createUTC([2e3,e]),s&&!this._longMonthsParse[e]&&(this._longMonthsParse[e]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[e]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),s||this._monthsParse[e]||(n="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[e]=new RegExp(n.replace(".",""),"i")),s&&"MMMM"===o&&this._longMonthsParse[e].test(t))return e;if(s&&"MMM"===o&&this._shortMonthsParse[e].test(t))return e;if(!s&&this._monthsParse[e].test(t))return e}}export function setMonth(t,o){var s;if(!t.isValid())return t;if("string"==typeof o)if(/^\d+$/.test(o))o=toInt(o);else if(o=t.localeData().monthsParse(o),!isNumber(o))return t;return s=Math.min(t.date(),daysInMonth(t.year(),o)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](o,s),t}export function getSetMonth(t){return null!=t?(setMonth(this,t),hooks.updateOffset(this,!0),this):get(this,"Month")}export function getDaysInMonth(){return daysInMonth(this.year(),this.month())}var defaultMonthsShortRegex=matchWord;export function monthsShortRegex(t){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}var defaultMonthsRegex=matchWord;export function monthsRegex(t){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),t?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function computeMonthsParse(){function t(t,o){return o.length-t.length}var o,s,e=[],r=[],n=[];for(o=0;o<12;o++)s=createUTC([2e3,o]),e.push(this.monthsShort(s,"")),r.push(this.months(s,"")),n.push(this.months(s,"")),n.push(this.monthsShort(s,""));for(e.sort(t),r.sort(t),n.sort(t),o=0;o<12;o++)e[o]=regexEscape(e[o]),r[o]=regexEscape(r[o]);for(o=0;o<24;o++)n[o]=regexEscape(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}