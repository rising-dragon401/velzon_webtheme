import{addFormatToken}from"../format/format";import{addUnitAlias}from"./aliases";import{addUnitPriority}from"./priorities";import{addRegexToken,match1to2,matchWord,regexEscape}from"../parse/regex";import{addWeekParseToken}from"../parse/token";import toInt from"../utils/to-int";import isArray from"../utils/is-array";import indexOf from"../utils/index-of";import hasOwnProp from"../utils/has-own-prop";import{createUTC}from"../create/utc";import getParsingFlags from"../create/parsing-flags";function parseWeekday(e,a){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=a.weekdaysParse(e))?e:null:parseInt(e,10)}function parseIsoWeekday(e,a){return"string"==typeof e?a.weekdaysParse(e)%7||7:isNaN(e)?null:e}function shiftWeekdays(e,a){return e.slice(a,7).concat(e.slice(0,a))}addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),addFormatToken("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),addFormatToken("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addUnitAlias("day","d"),addUnitAlias("weekday","e"),addUnitAlias("isoWeekday","E"),addUnitPriority("day",11),addUnitPriority("weekday",11),addUnitPriority("isoWeekday",11),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",(function(e,a){return a.weekdaysMinRegex(e)})),addRegexToken("ddd",(function(e,a){return a.weekdaysShortRegex(e)})),addRegexToken("dddd",(function(e,a){return a.weekdaysRegex(e)})),addWeekParseToken(["dd","ddd","dddd"],(function(e,a,s,t){var d=s._locale.weekdaysParse(e,t,s._strict);null!=d?a.d=d:getParsingFlags(s).invalidWeekday=e})),addWeekParseToken(["d","e","E"],(function(e,a,s,t){a[t]=toInt(e)}));export var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");export function localeWeekdays(e,a){var s=isArray(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(a)?"format":"standalone"];return!0===e?shiftWeekdays(s,this._week.dow):e?s[e.day()]:s}export var defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");export function localeWeekdaysShort(e){return!0===e?shiftWeekdays(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}export var defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_");export function localeWeekdaysMin(e){return!0===e?shiftWeekdays(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function handleStrictParse(e,a,s){var t,d,i,r=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],t=0;t<7;++t)i=createUTC([2e3,1]).day(t),this._minWeekdaysParse[t]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[t]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[t]=this.weekdays(i,"").toLocaleLowerCase();return s?"dddd"===a?-1!==(d=indexOf.call(this._weekdaysParse,r))?d:null:"ddd"===a?-1!==(d=indexOf.call(this._shortWeekdaysParse,r))?d:null:-1!==(d=indexOf.call(this._minWeekdaysParse,r))?d:null:"dddd"===a?-1!==(d=indexOf.call(this._weekdaysParse,r))||-1!==(d=indexOf.call(this._shortWeekdaysParse,r))||-1!==(d=indexOf.call(this._minWeekdaysParse,r))?d:null:"ddd"===a?-1!==(d=indexOf.call(this._shortWeekdaysParse,r))||-1!==(d=indexOf.call(this._weekdaysParse,r))||-1!==(d=indexOf.call(this._minWeekdaysParse,r))?d:null:-1!==(d=indexOf.call(this._minWeekdaysParse,r))||-1!==(d=indexOf.call(this._weekdaysParse,r))||-1!==(d=indexOf.call(this._shortWeekdaysParse,r))?d:null}export function localeWeekdaysParse(e,a,s){var t,d,i;if(this._weekdaysParseExact)return handleStrictParse.call(this,e,a,s);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),t=0;t<7;t++){if(d=createUTC([2e3,1]).day(t),s&&!this._fullWeekdaysParse[t]&&(this._fullWeekdaysParse[t]=new RegExp("^"+this.weekdays(d,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[t]=new RegExp("^"+this.weekdaysShort(d,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[t]=new RegExp("^"+this.weekdaysMin(d,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[t]||(i="^"+this.weekdays(d,"")+"|^"+this.weekdaysShort(d,"")+"|^"+this.weekdaysMin(d,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")),s&&"dddd"===a&&this._fullWeekdaysParse[t].test(e))return t;if(s&&"ddd"===a&&this._shortWeekdaysParse[t].test(e))return t;if(s&&"dd"===a&&this._minWeekdaysParse[t].test(e))return t;if(!s&&this._weekdaysParse[t].test(e))return t}}export function getSetDayOfWeek(e){if(!this.isValid())return null!=e?this:NaN;var a=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=parseWeekday(e,this.localeData()),this.add(e-a,"d")):a}export function getSetLocaleDayOfWeek(e){if(!this.isValid())return null!=e?this:NaN;var a=(this.day()+7-this.localeData()._week.dow)%7;return null==e?a:this.add(e-a,"d")}export function getSetISODayOfWeek(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var a=parseIsoWeekday(e,this.localeData());return this.day(this.day()%7?a:a-7)}return this.day()||7}var defaultWeekdaysRegex=matchWord;export function weekdaysRegex(e){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}var defaultWeekdaysShortRegex=matchWord;export function weekdaysShortRegex(e){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}var defaultWeekdaysMinRegex=matchWord;export function weekdaysMinRegex(e){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function computeWeekdaysParse(){function e(e,a){return a.length-e.length}var a,s,t,d,i,r=[],n=[],o=[],h=[];for(a=0;a<7;a++)s=createUTC([2e3,1]).day(a),t=this.weekdaysMin(s,""),d=this.weekdaysShort(s,""),i=this.weekdays(s,""),r.push(t),n.push(d),o.push(i),h.push(t),h.push(d),h.push(i);for(r.sort(e),n.sort(e),o.sort(e),h.sort(e),a=0;a<7;a++)n[a]=regexEscape(n[a]),o[a]=regexEscape(o[a]),h[a]=regexEscape(h[a]);this._weekdaysRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+r.join("|")+")","i")}