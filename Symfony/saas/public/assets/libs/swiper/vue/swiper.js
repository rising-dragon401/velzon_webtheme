import{h,ref,onMounted,onUpdated,onBeforeUnmount,watch,nextTick,provide}from"vue";import SwiperCore from"swiper";import{getParams}from"../components-shared/get-params.js";import{mountSwiper}from"../components-shared/mount-swiper.js";import{needsScrollbar,needsNavigation,needsPagination,uniqueClasses,extend,wrapperClass}from"../components-shared/utils.js";import{getChangedParams}from"../components-shared/get-changed-params.js";import{getChildren}from"./get-children.js";import{updateSwiper}from"../components-shared/update-swiper.js";import{renderVirtual}from"./virtual.js";import{updateOnVirtualData}from"../components-shared/update-on-virtual-data.js";const Swiper={name:"Swiper",props:{tag:{type:String,default:"div"},wrapperTag:{type:String,default:"div"},modules:{type:Array,default:void 0},init:{type:Boolean,default:void 0},direction:{type:String,default:void 0},oneWayMovement:{type:Boolean,default:void 0},touchEventsTarget:{type:String,default:void 0},initialSlide:{type:Number,default:void 0},speed:{type:Number,default:void 0},cssMode:{type:Boolean,default:void 0},updateOnWindowResize:{type:Boolean,default:void 0},resizeObserver:{type:Boolean,default:void 0},nested:{type:Boolean,default:void 0},focusableElements:{type:String,default:void 0},width:{type:Number,default:void 0},height:{type:Number,default:void 0},preventInteractionOnTransition:{type:Boolean,default:void 0},userAgent:{type:String,default:void 0},url:{type:String,default:void 0},edgeSwipeDetection:{type:[Boolean,String],default:void 0},edgeSwipeThreshold:{type:Number,default:void 0},autoHeight:{type:Boolean,default:void 0},setWrapperSize:{type:Boolean,default:void 0},virtualTranslate:{type:Boolean,default:void 0},effect:{type:String,default:void 0},breakpoints:{type:Object,default:void 0},spaceBetween:{type:[Number,String],default:void 0},slidesPerView:{type:[Number,String],default:void 0},maxBackfaceHiddenSlides:{type:Number,default:void 0},slidesPerGroup:{type:Number,default:void 0},slidesPerGroupSkip:{type:Number,default:void 0},slidesPerGroupAuto:{type:Boolean,default:void 0},centeredSlides:{type:Boolean,default:void 0},centeredSlidesBounds:{type:Boolean,default:void 0},slidesOffsetBefore:{type:Number,default:void 0},slidesOffsetAfter:{type:Number,default:void 0},normalizeSlideIndex:{type:Boolean,default:void 0},centerInsufficientSlides:{type:Boolean,default:void 0},watchOverflow:{type:Boolean,default:void 0},roundLengths:{type:Boolean,default:void 0},touchRatio:{type:Number,default:void 0},touchAngle:{type:Number,default:void 0},simulateTouch:{type:Boolean,default:void 0},shortSwipes:{type:Boolean,default:void 0},longSwipes:{type:Boolean,default:void 0},longSwipesRatio:{type:Number,default:void 0},longSwipesMs:{type:Number,default:void 0},followFinger:{type:Boolean,default:void 0},allowTouchMove:{type:Boolean,default:void 0},threshold:{type:Number,default:void 0},touchMoveStopPropagation:{type:Boolean,default:void 0},touchStartPreventDefault:{type:Boolean,default:void 0},touchStartForcePreventDefault:{type:Boolean,default:void 0},touchReleaseOnEdges:{type:Boolean,default:void 0},uniqueNavElements:{type:Boolean,default:void 0},resistance:{type:Boolean,default:void 0},resistanceRatio:{type:Number,default:void 0},watchSlidesProgress:{type:Boolean,default:void 0},grabCursor:{type:Boolean,default:void 0},preventClicks:{type:Boolean,default:void 0},preventClicksPropagation:{type:Boolean,default:void 0},slideToClickedSlide:{type:Boolean,default:void 0},loop:{type:Boolean,default:void 0},loopedSlides:{type:Number,default:void 0},loopPreventsSliding:{type:Boolean,default:void 0},rewind:{type:Boolean,default:void 0},allowSlidePrev:{type:Boolean,default:void 0},allowSlideNext:{type:Boolean,default:void 0},swipeHandler:{type:Boolean,default:void 0},noSwiping:{type:Boolean,default:void 0},noSwipingClass:{type:String,default:void 0},noSwipingSelector:{type:String,default:void 0},passiveListeners:{type:Boolean,default:void 0},containerModifierClass:{type:String,default:void 0},slideClass:{type:String,default:void 0},slideActiveClass:{type:String,default:void 0},slideVisibleClass:{type:String,default:void 0},slideNextClass:{type:String,default:void 0},slidePrevClass:{type:String,default:void 0},wrapperClass:{type:String,default:void 0},lazyPreloaderClass:{type:String,default:void 0},lazyPreloadPrevNext:{type:Number,default:void 0},runCallbacksOnInit:{type:Boolean,default:void 0},observer:{type:Boolean,default:void 0},observeParents:{type:Boolean,default:void 0},observeSlideChildren:{type:Boolean,default:void 0},a11y:{type:[Boolean,Object],default:void 0},autoplay:{type:[Boolean,Object],default:void 0},controller:{type:Object,default:void 0},coverflowEffect:{type:Object,default:void 0},cubeEffect:{type:Object,default:void 0},fadeEffect:{type:Object,default:void 0},flipEffect:{type:Object,default:void 0},creativeEffect:{type:Object,default:void 0},cardsEffect:{type:Object,default:void 0},hashNavigation:{type:[Boolean,Object],default:void 0},history:{type:[Boolean,Object],default:void 0},keyboard:{type:[Boolean,Object],default:void 0},mousewheel:{type:[Boolean,Object],default:void 0},navigation:{type:[Boolean,Object],default:void 0},pagination:{type:[Boolean,Object],default:void 0},parallax:{type:[Boolean,Object],default:void 0},scrollbar:{type:[Boolean,Object],default:void 0},thumbs:{type:Object,default:void 0},virtual:{type:[Boolean,Object],default:void 0},zoom:{type:[Boolean,Object],default:void 0},grid:{type:[Object],default:void 0},freeMode:{type:[Boolean,Object],default:void 0},enabled:{type:Boolean,default:void 0}},emits:["_beforeBreakpoint","_containerClasses","_slideClass","_slideClasses","_swiper","_freeModeNoMomentumRelease","activeIndexChange","afterInit","autoplay","autoplayStart","autoplayStop","autoplayPause","autoplayResume","autoplayTimeLeft","beforeDestroy","beforeInit","beforeLoopFix","beforeResize","beforeSlideChangeStart","beforeTransitionStart","breakpoint","changeDirection","click","disable","doubleTap","doubleClick","destroy","enable","fromEdge","hashChange","hashSet","init","keyPress","lock","loopFix","momentumBounce","navigationHide","navigationShow","navigationPrev","navigationNext","observerUpdate","orientationchange","paginationHide","paginationRender","paginationShow","paginationUpdate","progress","reachBeginning","reachEnd","realIndexChange","resize","scroll","scrollbarDragEnd","scrollbarDragMove","scrollbarDragStart","setTransition","setTranslate","slideChange","slideChangeTransitionEnd","slideChangeTransitionStart","slideNextTransitionEnd","slideNextTransitionStart","slidePrevTransitionEnd","slidePrevTransitionStart","slideResetTransitionStart","slideResetTransitionEnd","sliderMove","sliderFirstMove","slidesLengthChange","slidesGridLengthChange","snapGridLengthChange","snapIndexChange","swiper","tap","toEdge","touchEnd","touchMove","touchMoveOpposite","touchStart","transitionEnd","transitionStart","unlock","update","virtualUpdate","zoomChange"],setup(e,t){let{slots:a,emit:o}=t;const{tag:l,wrapperTag:i}=e,d=ref("swiper"),r=ref(null),n=ref(!1),s=ref(!1),u=ref(null),p=ref(null),v=ref(null),f={value:[]},y={value:[]},c=ref(null),g=ref(null),m=ref(null),b=ref(null),{params:S,passedParams:B}=getParams(e,!1);getChildren(a,f,y),v.value=B,y.value=f.value;S.onAny=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),l=1;l<t;l++)a[l-1]=arguments[l];o(e,...a)},Object.assign(S.on,{_beforeBreakpoint:()=>{getChildren(a,f,y),n.value=!0},_containerClasses(e,t){d.value=t}});const w={...S};if(delete w.wrapperClass,p.value=new SwiperCore(w),p.value.virtual&&p.value.params.virtual.enabled){p.value.virtual.slides=f.value;const e={cache:!1,slides:f.value,renderExternal:e=>{r.value=e},renderExternalUpdate:!1};extend(p.value.params.virtual,e),extend(p.value.originalParams.virtual,e)}function C(e){return S.virtual?renderVirtual(p,e,r.value):(e.forEach(((e,t)=>{e.props||(e.props={}),e.props.swiperRef=p,e.props.swiperSlideIndex=t})),e)}return onUpdated((()=>{!s.value&&p.value&&(p.value.emitSlidesClasses(),s.value=!0);const{passedParams:t}=getParams(e,!1),a=getChangedParams(t,v.value,f.value,y.value,(e=>e.props&&e.props.key));v.value=t,(a.length||n.value)&&p.value&&!p.value.destroyed&&updateSwiper({swiper:p.value,slides:f.value,passedParams:t,changedParams:a,nextEl:c.value,prevEl:g.value,scrollbarEl:b.value,paginationEl:m.value}),n.value=!1})),provide("swiper",p),watch(r,(()=>{nextTick((()=>{updateOnVirtualData(p.value)}))})),onMounted((()=>{u.value&&(mountSwiper({el:u.value,nextEl:c.value,prevEl:g.value,paginationEl:m.value,scrollbarEl:b.value,swiper:p.value},S),o("swiper",p.value))})),onBeforeUnmount((()=>{p.value&&!p.value.destroyed&&p.value.destroy(!0,!1)})),()=>{const{slides:t,slots:o}=getChildren(a,f,y);return h(l,{ref:u,class:uniqueClasses(d.value)},[o["container-start"],h(i,{class:wrapperClass(S.wrapperClass)},[o["wrapper-start"],C(t),o["wrapper-end"]]),needsNavigation(e)&&[h("div",{ref:g,class:"swiper-button-prev"}),h("div",{ref:c,class:"swiper-button-next"})],needsScrollbar(e)&&h("div",{ref:b,class:"swiper-scrollbar"}),needsPagination(e)&&h("div",{ref:m,class:"swiper-pagination"}),o["container-end"]])}}};export{Swiper};