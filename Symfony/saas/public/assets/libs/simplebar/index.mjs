import t from"can-use-dom";import e from"simplebar-core";var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},i(t,e)};var n=e.helpers,s=n.getOptions,a=n.addClasses,r=function(t){function n(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var s=t.apply(this,e)||this;return n.instances.set(e[0],s),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(n,t),n.initDOMLoadedElements=function(){document.removeEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.removeEventListener("load",this.initDOMLoadedElements),Array.prototype.forEach.call(document.querySelectorAll("[data-simplebar]"),(function(t){"init"===t.getAttribute("data-simplebar")||n.instances.has(t)||new n(t,s(t.attributes))}))},n.removeObserver=function(){var t;null===(t=n.globalObserver)||void 0===t||t.disconnect()},n.prototype.initDOM=function(){var t,i,n,s=this;if(!Array.prototype.filter.call(this.el.children,(function(t){return t.classList.contains(s.classNames.wrapper)})).length){for(this.wrapperEl=document.createElement("div"),this.contentWrapperEl=document.createElement("div"),this.offsetEl=document.createElement("div"),this.maskEl=document.createElement("div"),this.contentEl=document.createElement("div"),this.placeholderEl=document.createElement("div"),this.heightAutoObserverWrapperEl=document.createElement("div"),this.heightAutoObserverEl=document.createElement("div"),a(this.wrapperEl,this.classNames.wrapper),a(this.contentWrapperEl,this.classNames.contentWrapper),a(this.offsetEl,this.classNames.offset),a(this.maskEl,this.classNames.mask),a(this.contentEl,this.classNames.contentEl),a(this.placeholderEl,this.classNames.placeholder),a(this.heightAutoObserverWrapperEl,this.classNames.heightAutoObserverWrapperEl),a(this.heightAutoObserverEl,this.classNames.heightAutoObserverEl);this.el.firstChild;)this.contentEl.appendChild(this.el.firstChild);this.contentWrapperEl.appendChild(this.contentEl),this.offsetEl.appendChild(this.contentWrapperEl),this.maskEl.appendChild(this.offsetEl),this.heightAutoObserverWrapperEl.appendChild(this.heightAutoObserverEl),this.wrapperEl.appendChild(this.heightAutoObserverWrapperEl),this.wrapperEl.appendChild(this.maskEl),this.wrapperEl.appendChild(this.placeholderEl),this.el.appendChild(this.wrapperEl),null===(t=this.contentWrapperEl)||void 0===t||t.setAttribute("tabindex","0"),null===(i=this.contentWrapperEl)||void 0===i||i.setAttribute("role","region"),null===(n=this.contentWrapperEl)||void 0===n||n.setAttribute("aria-label",this.options.ariaLabel)}if(!this.axis.x.track.el||!this.axis.y.track.el){var r=document.createElement("div"),o=document.createElement("div");a(r,this.classNames.track),a(o,this.classNames.scrollbar),r.appendChild(o),this.axis.x.track.el=r.cloneNode(!0),a(this.axis.x.track.el,this.classNames.horizontal),this.axis.y.track.el=r.cloneNode(!0),a(this.axis.y.track.el,this.classNames.vertical),this.el.appendChild(this.axis.x.track.el),this.el.appendChild(this.axis.y.track.el)}e.prototype.initDOM.call(this),this.el.setAttribute("data-simplebar","init")},n.prototype.unMount=function(){e.prototype.unMount.call(this),n.instances.delete(this.el)},n.initHtmlApi=function(){this.initDOMLoadedElements=this.initDOMLoadedElements.bind(this),"undefined"!=typeof MutationObserver&&(this.globalObserver=new MutationObserver(n.handleMutations),this.globalObserver.observe(document,{childList:!0,subtree:!0})),"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(this.initDOMLoadedElements):(document.addEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.addEventListener("load",this.initDOMLoadedElements))},n.handleMutations=function(t){t.forEach((function(t){t.addedNodes.forEach((function(t){1===t.nodeType&&(t.hasAttribute("data-simplebar")?!n.instances.has(t)&&document.documentElement.contains(t)&&new n(t,s(t.attributes)):t.querySelectorAll("[data-simplebar]").forEach((function(t){"init"!==t.getAttribute("data-simplebar")&&!n.instances.has(t)&&document.documentElement.contains(t)&&new n(t,s(t.attributes))})))})),t.removedNodes.forEach((function(t){1===t.nodeType&&("init"===t.getAttribute("data-simplebar")?n.instances.has(t)&&!document.documentElement.contains(t)&&n.instances.get(t).unMount():Array.prototype.forEach.call(t.querySelectorAll('[data-simplebar="init"]'),(function(t){n.instances.has(t)&&!document.documentElement.contains(t)&&n.instances.get(t).unMount()})))}))}))},n.instances=new WeakMap,n}(e);t&&r.initHtmlApi();export{r as default};